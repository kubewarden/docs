<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-security/threat-model">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Kubewarden</title><meta data-rh="true" property="og:title" content="Kubewarden"><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.kubewarden.io/security/threat-model"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="description" content="The Kubernetes SIG Security team has"><meta data-rh="true" property="og:description" content="The Kubernetes SIG Security team has"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.kubewarden.io/security/threat-model"><link data-rh="true" rel="alternate" href="https://docs.kubewarden.io/security/threat-model" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.kubewarden.io/security/threat-model" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://D1IWU8P361-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-56382716-13","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>


<link rel="search" type="application/opensearchdescription+xml" title="Kubewarden" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.671eb678.css">
<link rel="preload" href="/assets/js/runtime~main.2c7e3a73.js" as="script">
<link rel="preload" href="/assets/js/main.c973c24f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/icon-kubewarden.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/icon-kubewarden.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Kubewarden, a CNCF Sandbox Project</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__docs navbar__link--active" href="/">Docs</a><a href="https://github.com/kubewarden/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__github btn btn-secondary icon-github">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/quick-start">Quick Start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/tasks">Common Tasks</a><button aria-label="Toggle the collapsible sidebar category &#x27;Common Tasks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/writing-policies">Writing Policies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Writing Policies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/distributing-policies">Distributing Policies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Distributing Policies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/testing-policies/intro">Testing Policies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Testing Policies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/operator-manual/intro">Operator Manual</a><button aria-label="Toggle the collapsible sidebar category &#x27;Operator Manual&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/security/intro">Security</a><button aria-label="Toggle the collapsible sidebar category &#x27;Security&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/security/threat-model">Threat Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/security/verifying-kubewarden">Verifying Kubewarden</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/security/disclosure">Disclosure</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/security/intro"><span itemprop="name">Security</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Threat Model</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Threat Model</h1><p>The <a href="https://github.com/kubernetes/community/tree/master/sig-security" target="_blank" rel="noopener noreferrer">Kubernetes SIG Security team</a> has
defined an Admission Control Threat Model. The Kubewarden team has evaluated
Kubewarden against this threat model, and strives to provide secure defaults
that cover it. Still, it is recommended for Kubewarden administrators to read
and understand the threat model, and use it to devise their own thread model as
needed.</p><p>If more details about each threat is needed, refer to the <a href="https://github.com/kubernetes/sig-security/tree/main/sig-security-docs/papers/admission-control" target="_blank" rel="noopener noreferrer">original document published by SIG Security</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-1---attacker-floods-webhook-with-traffic-preventing-its-operation">Threat 1 - Attacker floods webhook with traffic preventing its operation<a class="hash-link" href="#threat-1---attacker-floods-webhook-with-traffic-preventing-its-operation" title="Direct link to heading">​</a></h2><p>An attacker who has access to the Webhook endpoint, at the network level, could
send large quantities of traffic, causing an effective denial of service to the
admission controller.</p><p><strong>Mitigation</strong></p><p>Webhook fails closed. In other words, if the webhook does not respond in time,
for any reason, the API server should reject the request.
Kubewarden default behavior already does that.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-2---attacker-passes-workloads-which-require-complex--processing-causing-timeouts">Threat 2 - Attacker passes workloads which require complex  processing causing timeouts<a class="hash-link" href="#threat-2---attacker-passes-workloads-which-require-complex--processing-causing-timeouts" title="Direct link to heading">​</a></h2><p>An attacker, who can access the admission controller at a network level, passes
requests to the admission controller requiring complex processing and causing
timeouts as the admission controller utilizes compute power to process the workloads</p><p><strong>Mitigation</strong>
Webhook fail closed and authenticate callers. Kubewarden default behaviour
already does that.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-3---attacker-exploits-misconfiguration-of-webhook-to-bypass">Threat 3 - Attacker exploits misconfiguration of webhook to bypass<a class="hash-link" href="#threat-3---attacker-exploits-misconfiguration-of-webhook-to-bypass" title="Direct link to heading">​</a></h2><p>An attacker, who has rights to create workloads in the cluster, is able to exploit
a misconfiguration to bypass the intended security control.</p><p><strong>Mitigation</strong>
Regular reviews of webhook configuration can help catch issues.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-4---attacker-has-rights-to-delete-or-modify-the-k8s-webhook--object">Threat 4 - Attacker has rights to delete or modify the k8s webhook  object<a class="hash-link" href="#threat-4---attacker-has-rights-to-delete-or-modify-the-k8s-webhook--object" title="Direct link to heading">​</a></h2><p>An attacker who has Kubernetes API access, has sufficient privileges to delete
the webhook object in the cluster.</p><p><strong>Mitigation</strong>
RBAC rights are strictly controlled.</p><p><strong>To do</strong>
Most of RBAC isn&#x27;t within the scope of the current discussion.
However, the following will be provided in due course for helping Kubewarden
users:</p><ul><li>Directions around minimum RBAC to be implemented.</li><li>Provision &amp; documentation of a policy that detects and could potentially block RBAC changes.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-5---attacker-gets-access-to-valid-credentials-for-the-webhook">Threat 5 - Attacker gets access to valid credentials for the webhook<a class="hash-link" href="#threat-5---attacker-gets-access-to-valid-credentials-for-the-webhook" title="Direct link to heading">​</a></h2><p>An attacker gains access to valid client credentials for the admission controller webhook</p><p><strong>Mitigation</strong>
Webhook fails closed.</p><p>Kubewarden default behaviour is failed closed. Thus, it covers this.</p><p>(Failing closed means that if, for any reason, Kubewarden stops responding or
crashes, the API server will reject the request by default, even if the request
would be accepted by Kubewarden in normal situations)</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat--6---attacker-gains-access-to-a-cluster-admin-credential">Threat  6 - Attacker gains access to a cluster admin credential<a class="hash-link" href="#threat--6---attacker-gains-access-to-a-cluster-admin-credential" title="Direct link to heading">​</a></h2><p>An attacker gains access to a cluster-admin level credential in the kubernetes cluster.</p><p><strong>Mitigation</strong>
N/A</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-7---attacker-sniffs-traffic-on-the-container-network">Threat 7 - Attacker sniffs traffic on the container network<a class="hash-link" href="#threat-7---attacker-sniffs-traffic-on-the-container-network" title="Direct link to heading">​</a></h2><p>An attacker who has access to the container network is able to sniff traffic
between the API  server and the admission controller webhook.</p><p><strong>Mitigation</strong>
Since the webhook uses TLS encryption for all traffic, Kubewarden is safe.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-8---attacker-carries-out-a-mitm-attack-on-the-webhook">Threat 8 - Attacker carries out a MITM attack on the webhook<a class="hash-link" href="#threat-8---attacker-carries-out-a-mitm-attack-on-the-webhook" title="Direct link to heading">​</a></h2><p>An attacker on the container network, who has access to the NET_RAW capability
can attempt to use MITM tooling to intercept traffic between the API server
and admission controller webhook.</p><p><strong>Mitigation</strong>
Webhook mTLS authentication is used.</p><p><strong>To do</strong>
Implement mutual TLS authentication.
Additionally, it would be possible to add a policy within the recommended
policies section in the <code>kubewarden-defaults</code> which drops the <code>NET_RAW</code>
capability.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-9---attacker-steals-traffic-from-the-webhook-via-spoofing">Threat 9 - Attacker steals traffic from the webhook via spoofing<a class="hash-link" href="#threat-9---attacker-steals-traffic-from-the-webhook-via-spoofing" title="Direct link to heading">​</a></h2><p>An attacker is able to redirect traffic from the API server which is intended
for the admission controller webhook by spoofing.</p><p><strong>Mitigation</strong>
Webhook mTLS authentication is used.</p><p><strong>To do</strong>
Kubewarden should implement mutual TLS authentication</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-10---abusing-a-mutation-rule-to-create-a-privileged-container">Threat 10 - Abusing a mutation rule to create a privileged container<a class="hash-link" href="#threat-10---abusing-a-mutation-rule-to-create-a-privileged-container" title="Direct link to heading">​</a></h2><p>An attacker is able to cause a mutating admission controller to modify a workload,
such that it allows for privileged container creation.</p><p><strong>Mitigation</strong>
All rules are reviewed and tested.</p><p><strong>To do</strong>
The Kubewarden team may come up with some tests to cover the review of these rules in the future.
In addition to the above, any change of rules during policies deployment must be carefully reviewed.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-11---attacker-deploys-workloads-to-namespaces-that-are--exempt-from-admission-control">Threat 11 - Attacker deploys workloads to namespaces that are  exempt from admission control<a class="hash-link" href="#threat-11---attacker-deploys-workloads-to-namespaces-that-are--exempt-from-admission-control" title="Direct link to heading">​</a></h2><p>An attacker is able to deploy workloads to Kubernetes namespaces that are exempt
from the admission controller configuration.</p><p><strong>Mitigation</strong>
RBAC rights are strictly controlled</p><p><strong>To do</strong>
Most of the RBAC is out of scope with respect to this decision. However, the Kubewarden team aims to:</p><ul><li>Warn users via our docs and <em>suggest</em> some minimum RBAC to be used.</li><li>Provide a policy which detects RBAC changes and <strong>maybe</strong> block them.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-12---block-rule-can-be-bypassed-due-to-missing-match-eg--missing-initcontainers">Threat 12 - Block rule can be bypassed due to missing match (e.g.  missing initcontainers)<a class="hash-link" href="#threat-12---block-rule-can-be-bypassed-due-to-missing-match-eg--missing-initcontainers" title="Direct link to heading">​</a></h2><p>An attacker created a workload manifest which uses a feature of the Kubernetes
API which is not covered by the admission controller</p><p><strong>Mitigation</strong>
All rules are reviewed and tested.</p><p><strong>To do</strong>
Introduce tests to cover this rule.
As always, carefully review PRs changing the rules in the policies deployment.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-13---attacker-exploits-bad-string-matching-on-a-blocklist-to--bypass-rules">Threat 13 - Attacker exploits bad string matching on a blocklist to  bypass rules<a class="hash-link" href="#threat-13---attacker-exploits-bad-string-matching-on-a-blocklist-to--bypass-rules" title="Direct link to heading">​</a></h2><p>An attacker, who has rights to create workloads, bypasses a rule by exploiting
bad string matching.</p><p><strong>Mitigation</strong>
All rules are reviewed and tested.</p><p><strong>To do</strong>
Introduce tests to cover this rule.
As always, carefully review PRs changing the rules in the policies deployment.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-14---attacker-uses-newold-features-of-the-kubernetes-api--which-have-no-rules">Threat 14 - Attacker uses new/old features of the Kubernetes API  which have no rules<a class="hash-link" href="#threat-14---attacker-uses-newold-features-of-the-kubernetes-api--which-have-no-rules" title="Direct link to heading">​</a></h2><p>An attacker, with rights to create workloads, uses new features of the Kubernetes
API (for example, a changed API version) to bypass a rule.</p><p><strong>Mitigation</strong>
All rules are reviewed and tested.</p><p><strong>To do</strong>
Introduce tests to cover this rule.
Create a configuration to reject requests where the API version not
cover by the policy by default. Kubewarden should warn policy developers to cover all the
supported API version in their tests and reject all others.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-15---attacker-deploys-privileged-container-to-node-running--webhook-controller">Threat 15 - Attacker deploys privileged container to node running  Webhook controller<a class="hash-link" href="#threat-15---attacker-deploys-privileged-container-to-node-running--webhook-controller" title="Direct link to heading">​</a></h2><p>An attacker, who has rights to deploy privileged containers to the cluster, creates
a privileged container on the cluster node where the admission controller webhook operates.</p><p><strong>Mitigation</strong>
Admission controller uses restrictive policies to prevent privileged workloads.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-16---attacker-mounts-a-privileged-node-hostpath-allowing--modification-of-webhook-controller-configuration">Threat 16 - Attacker mounts a privileged node hostpath allowing  modification of Webhook controller configuration<a class="hash-link" href="#threat-16---attacker-mounts-a-privileged-node-hostpath-allowing--modification-of-webhook-controller-configuration" title="Direct link to heading">​</a></h2><p>An attacker, who has rights to deploy hostPath volumes with workloads, creates a
volume that allows for access to the admission controller pod’s files.</p><p><strong>Mitigation</strong>
Admission controller uses restrictive policies to prevent privileged  workloads</p><p><strong>To do</strong>
Add a recommended policy in the <code>kubewarden-default</code> Helm chart to prevent this.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-17---attacker-has-privileged-ssh-access-to-cluster-node--running-admission-webhook">Threat 17 - Attacker has privileged SSH access to cluster node  running admission webhook<a class="hash-link" href="#threat-17---attacker-has-privileged-ssh-access-to-cluster-node--running-admission-webhook" title="Direct link to heading">​</a></h2><p>An attacker is able to log into cluster nodes as a privileged user via SSH.</p><p><strong>Mitigation</strong>
N/A</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-18---attacker-uses-policies-to-send-confidential-data-from--admission-requests-to-external-systems">Threat 18 - Attacker uses policies to send confidential data from  admission requests to external systems<a class="hash-link" href="#threat-18---attacker-uses-policies-to-send-confidential-data-from--admission-requests-to-external-systems" title="Direct link to heading">​</a></h2><p>An attacker is able to configure a policy that listens to admission requests and
sends sensitive data to an external system.</p><p><strong>Mitigation</strong>
Strictly control external access for webhook</p><p>Kubewarden policies run in a restrictive environment. They do not have network access.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-kubewarden-1---bootstrapping-of-trust-for-admission-controller">Threat Kubewarden 1 - Bootstrapping of trust for admission controller<a class="hash-link" href="#threat-kubewarden-1---bootstrapping-of-trust-for-admission-controller" title="Direct link to heading">​</a></h2><p>Assuming a trusted but fresh Kubernetes cluster, an attacker is able to compromise the Kubewarden stack
before any of the policies securing it are deployed and enforced. For example, by using unsigned and
malicious images for kubewarden-controller, policy-server, or any of the Kubewarden dependencies
(cert-manager) or optional dependencies (grafana, prometheus, etc.), or by compromising
the Helm charts payload.</p><p><strong> Mitigation </strong></p><ol><li>Kubewarden provides a Software Bill Of Materials, which lists all images needed. This aids with Zero-Trust.
The Kubernetes Administrator must verify the Kubewarden images, its dependencies&#x27; images, and charts
out of the Kubernetes cluster, in a trusted environment. This can be done with <code>cosign</code>, for example.
Incidentally, this is part of the implementation needed for air-gapped installations.</li><li>Use signed Helm charts, and verified digests instead of tags for Kubewarden images in those Helm charts.
This doesn&#x27;t secure dependencies though.</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/kubewarden/docs/edit/main/docs/security/threat-model.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-11-22T20:25:15.000Z">Nov 22, 2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/security/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Security</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/security/verifying-kubewarden"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Verifying Kubewarden</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#threat-1---attacker-floods-webhook-with-traffic-preventing-its-operation" class="table-of-contents__link toc-highlight">Threat 1 - Attacker floods webhook with traffic preventing its operation</a></li><li><a href="#threat-2---attacker-passes-workloads-which-require-complex--processing-causing-timeouts" class="table-of-contents__link toc-highlight">Threat 2 - Attacker passes workloads which require complex  processing causing timeouts</a></li><li><a href="#threat-3---attacker-exploits-misconfiguration-of-webhook-to-bypass" class="table-of-contents__link toc-highlight">Threat 3 - Attacker exploits misconfiguration of webhook to bypass</a></li><li><a href="#threat-4---attacker-has-rights-to-delete-or-modify-the-k8s-webhook--object" class="table-of-contents__link toc-highlight">Threat 4 - Attacker has rights to delete or modify the k8s webhook  object</a></li><li><a href="#threat-5---attacker-gets-access-to-valid-credentials-for-the-webhook" class="table-of-contents__link toc-highlight">Threat 5 - Attacker gets access to valid credentials for the webhook</a></li><li><a href="#threat--6---attacker-gains-access-to-a-cluster-admin-credential" class="table-of-contents__link toc-highlight">Threat  6 - Attacker gains access to a cluster admin credential</a></li><li><a href="#threat-7---attacker-sniffs-traffic-on-the-container-network" class="table-of-contents__link toc-highlight">Threat 7 - Attacker sniffs traffic on the container network</a></li><li><a href="#threat-8---attacker-carries-out-a-mitm-attack-on-the-webhook" class="table-of-contents__link toc-highlight">Threat 8 - Attacker carries out a MITM attack on the webhook</a></li><li><a href="#threat-9---attacker-steals-traffic-from-the-webhook-via-spoofing" class="table-of-contents__link toc-highlight">Threat 9 - Attacker steals traffic from the webhook via spoofing</a></li><li><a href="#threat-10---abusing-a-mutation-rule-to-create-a-privileged-container" class="table-of-contents__link toc-highlight">Threat 10 - Abusing a mutation rule to create a privileged container</a></li><li><a href="#threat-11---attacker-deploys-workloads-to-namespaces-that-are--exempt-from-admission-control" class="table-of-contents__link toc-highlight">Threat 11 - Attacker deploys workloads to namespaces that are  exempt from admission control</a></li><li><a href="#threat-12---block-rule-can-be-bypassed-due-to-missing-match-eg--missing-initcontainers" class="table-of-contents__link toc-highlight">Threat 12 - Block rule can be bypassed due to missing match (e.g.  missing initcontainers)</a></li><li><a href="#threat-13---attacker-exploits-bad-string-matching-on-a-blocklist-to--bypass-rules" class="table-of-contents__link toc-highlight">Threat 13 - Attacker exploits bad string matching on a blocklist to  bypass rules</a></li><li><a href="#threat-14---attacker-uses-newold-features-of-the-kubernetes-api--which-have-no-rules" class="table-of-contents__link toc-highlight">Threat 14 - Attacker uses new/old features of the Kubernetes API  which have no rules</a></li><li><a href="#threat-15---attacker-deploys-privileged-container-to-node-running--webhook-controller" class="table-of-contents__link toc-highlight">Threat 15 - Attacker deploys privileged container to node running  Webhook controller</a></li><li><a href="#threat-16---attacker-mounts-a-privileged-node-hostpath-allowing--modification-of-webhook-controller-configuration" class="table-of-contents__link toc-highlight">Threat 16 - Attacker mounts a privileged node hostpath allowing  modification of Webhook controller configuration</a></li><li><a href="#threat-17---attacker-has-privileged-ssh-access-to-cluster-node--running-admission-webhook" class="table-of-contents__link toc-highlight">Threat 17 - Attacker has privileged SSH access to cluster node  running admission webhook</a></li><li><a href="#threat-18---attacker-uses-policies-to-send-confidential-data-from--admission-requests-to-external-systems" class="table-of-contents__link toc-highlight">Threat 18 - Attacker uses policies to send confidential data from  admission requests to external systems</a></li><li><a href="#threat-kubewarden-1---bootstrapping-of-trust-for-admission-controller" class="table-of-contents__link toc-highlight">Threat Kubewarden 1 - Bootstrapping of trust for admission controller</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Kubewarden Project Authors. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2c7e3a73.js"></script>
<script src="/assets/js/main.c973c24f.js"></script>
</body>
</html>