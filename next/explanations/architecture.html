<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-explanations/architecture" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Kubewarden architecture | Kubewarden</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.kubewarden.io/next/explanations/architecture"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Kubewarden architecture | Kubewarden"><meta data-rh="true" name="description" content="The Kubewarden architecture"><meta data-rh="true" property="og:description" content="The Kubewarden architecture"><meta data-rh="true" name="keywords" content="kubewarden,kubernetes,architecture"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="alternate" href="https://docs.kubewarden.io/next/explanations/architecture" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.kubewarden.io/next/explanations/architecture" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://D1IWU8P361-dsn.algolia.net" crossorigin="anonymous"><link data-rh="true" rel="canonical" href="https://docs.kubewarden.io/explanations/architecture"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PSW07XK7TM"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-PSW07XK7TM",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="Kubewarden" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.1bdf460b.css">
<script src="/assets/js/runtime~main.798cd5d5.js" defer="defer"></script>
<script src="/assets/js/main.0b94fe0b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/icon-kubewarden.svg" alt="The Kubewarden Project logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/icon-kubewarden.svg" alt="The Kubewarden Project logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Kubewarden</b></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/next/explanations/architecture">Next ðŸš§</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/next/explanations/architecture">Next ðŸš§</a></li><li><a class="dropdown__link" href="/explanations/architecture">1.21</a></li><li><a class="dropdown__link" href="/1.20/explanations/architecture">1.20</a></li><li><a class="dropdown__link" href="/1.19/explanations/architecture">1.19</a></li><li><a class="dropdown__link" href="/1.18/explanations/architecture">1.18</a></li><li><a class="dropdown__link" href="/1.17/explanations/architecture">1.17</a></li><li><a class="dropdown__link" href="/1.16/explanations/architecture">1.16</a></li><li><a class="dropdown__link" href="/1.15/explanations/architecture">1.15</a></li><li><a class="dropdown__link" href="/1.14/explanations/architecture">1.14</a></li><li><a class="dropdown__link" href="/1.13/explanations/architecture">1.13</a></li><li><a class="dropdown__link" href="/1.12/explanations/architecture">1.12</a></li><li><a class="dropdown__link" href="/1.11/explanations/architecture">1.11</a></li><li><a class="dropdown__link" href="/1.10">1.10</a></li><li><a class="dropdown__link" href="/1.9">1.9</a></li><li><a class="dropdown__link" href="/1.8">1.8</a></li><li><a class="dropdown__link" href="/1.7">1.7</a></li></ul></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kubewarden/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a href="https://kubernetes.slack.com/archives/kubewarden" target="_blank" rel="noopener noreferrer" class="dropdown__link">Slack<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://bsky.app/profile/kubewarden.io" target="_blank" rel="noopener noreferrer" class="dropdown__link">Bluesky<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://hachyderm.io/@kubewarden" target="_blank" rel="noopener noreferrer" class="dropdown__link">Mastodon<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/next">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/next/quick-start">Quick start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/next/tutorials/writing-policies">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/next/explanations/mutating-policies">Explanations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/explanations/mutating-policies">Mutating policies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/explanations/context-aware-policies">Context aware policies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/explanations/policy-groups">Policy Groups</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/explanations/certificates">Certificate rotation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/explanations/distributing-policies">Distributing policies</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/next/explanations/comparisons/opa-comparison">Comparisons</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/next/explanations/audit-scanner">Audit Scanner</a><button aria-label="Expand sidebar category &#x27;Audit Scanner&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/next/explanations/architecture">Architecture</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/next/howtos/tasks">Howtos</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/next/reference/CRDs">Reference</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/next/personas">For who?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/next/organization">Organization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/next/disclosure">Security disclosure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/next/glossary">Glossary</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->Kubewarden<!-- --> <b>Next ðŸš§</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/explanations/architecture">latest version</a></b> (<!-- -->1.21<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Explanations</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Architecture</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Next ðŸš§</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Kubewarden architecture</h1></header>
<p>Kubewarden is a Kubernetes policy engine.
It uses policies written in a programming language of your choosing.
This language must generate a WebAssembly binary for Kubewarden to use.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-a-policy">What <em>is</em> a policy?<a href="#what-is-a-policy" class="hash-link" aria-label="Direct link to what-is-a-policy" title="Direct link to what-is-a-policy">â€‹</a></h2>
<p>A policy is an <a href="https://opencontainers.org/" target="_blank" rel="noopener noreferrer">Open Container Initiative</a> (OCI)
artifact containing a WebAssembly module,
the policy code, and the metadata required by PolicyServer
performing admission request validations and mutations.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>In the same manner as
<a href="https://kubernetes.io/docs/contribute/style/style-guide/" target="_blank" rel="noopener noreferrer">Kubernetes</a>,
Kubewarden uses the terms
&#x27;PolicyServer&#x27; when discussing the Kubewarden policy server
and
<code>policy-server</code> when discussing Pod or Deployment of a Kubewarden PolicyServer.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="design-principles">Design principles<a href="#design-principles" class="hash-link" aria-label="Direct link to Design principles" title="Direct link to Design principles">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="making-use-of-core-kubernetes-features">Making use of core Kubernetes features<a href="#making-use-of-core-kubernetes-features" class="hash-link" aria-label="Direct link to Making use of core Kubernetes features" title="Direct link to Making use of core Kubernetes features">â€‹</a></h3>
<p>The team designed Kubewarden to use core features of Kubernetes,
without reinventing the wheel.
The project utilizes a combination of:</p>
<ul>
<li>Kubernetes Controllers</li>
<li>Custom Resource Definitions (CRDs)</li>
<li>Webhooks (Validation and Mutating)</li>
<li>the Control Plane&#x27;s event notification system</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="effectively-uses-kubernetes-architecture">Effectively uses Kubernetes architecture<a href="#effectively-uses-kubernetes-architecture" class="hash-link" aria-label="Direct link to Effectively uses Kubernetes architecture" title="Direct link to Effectively uses Kubernetes architecture">â€‹</a></h3>
<p>Kubewarden operates seamlessly within the Kubernetes ecosystem.
At its core, the Kubewarden controller is a Kubernetes controller,
monitoring Kubewarden Custom Resource Definitions (CRDs)
and configuring Kubernetes resources to execute them.
This integration ensures that Kubewarden uses the built-in Kubernetes mechanisms,
such as controllers and CRDs, to watch, manage, and apply security policies efficiently.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="extensible-policy-definition">Extensible policy definition<a href="#extensible-policy-definition" class="hash-link" aria-label="Direct link to Extensible policy definition" title="Direct link to Extensible policy definition">â€‹</a></h3>
<p>Kubewarden employs CRDs to define and manage Kubewarden resources,
which specify the rules for admission request validations.
This design enables users to extend Kubernetes&#x27; capabilities with custom admission controls,
ensuring that security and compliance policy enforcement is consistent across the cluster.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="direct-admission-control">Direct admission control<a href="#direct-admission-control" class="hash-link" aria-label="Direct link to Direct admission control" title="Direct link to Direct admission control">â€‹</a></h3>
<p>When setup by the Kubewarden controller,
the policy-server Service receives admission requests directly from the Kubernetes control plane,
using <code>ValidationWebhooks</code> and <code>MutatingWebhooks</code>.
This direct interaction streamlines the admission control process,
reducing latency and increasing efficiency in policy enforcement.</p>
<p>WebAssembly offers a sand-boxed execution environment,
ensuring policies run in isolation,
thus enhancing the security and stability of the policy enforcement mechanism.
This isolation prevents policies from interfering with each other or with the host system,
mitigating the risk of malicious code execution.
WebAssembly is portable and efficient,
enabling policies to run across different environments without modification.
This cross-platform compatibility ensures that Kubewarden policies are versatile,
and can be distributed and executed in diverse Kubernetes clusters</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="oci-based-policy-artifacts">OCI based policy artifacts<a href="#oci-based-policy-artifacts" class="hash-link" aria-label="Direct link to OCI based policy artifacts" title="Direct link to OCI based policy artifacts">â€‹</a></h3>
<p>Policies in Kubewarden are OCI (Open Container Initiative) artifacts.
This standardization makes the distribution and versioning of policies easier,
Policies contain both the WebAssembly modules for enforcement logic,
and metadata necessary for the PolicyServer&#x27;s operation.
Leveraging OCI artifacts promotes interoperability and ease of management
within cloud ecosystems.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fine-grained-policy-application">Fine-grained policy application<a href="#fine-grained-policy-application" class="hash-link" aria-label="Direct link to Fine-grained policy application" title="Direct link to Fine-grained policy application">â€‹</a></h3>
<p>Kubewarden associates policies with their own &#x27;validation&#x27; or &#x27;mutating&#x27; webhook,
allowing for fine-grained application of admission controls.
This flexibility enables administrators
to tailor the enforcement of policies according to specific needs,
enhancing the security and compliance posture of the Kubernetes cluster.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-kubewarden-stack">The Kubewarden stack<a href="#the-kubewarden-stack" class="hash-link" aria-label="Direct link to The Kubewarden stack" title="Direct link to The Kubewarden stack">â€‹</a></h2>
<p>The Kubewarden consists of these components:</p>
<ul>
<li>
<p>Kubewarden Custom Resources are
<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" target="_blank" rel="noopener noreferrer">Kubernetes Custom Resources</a>
that simplify the process of managing policies.</p>
<p>Kubewarden integrates with Kubernetes using
<a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/" target="_blank" rel="noopener noreferrer">Dynamic Admission Control</a>.
In particular, Kubewarden operates as a Kubernetes Admission Webhook.
The <code>policy-server</code> is the Webhook endpoint called by the Kubernetes API server to validate requests.</p>
</li>
<li>
<p>The <a href="https://github.com/kubewarden/kubewarden-controller" target="_blank" rel="noopener noreferrer">Kubewarden controller</a>
is a Kubernetes controller that reconciles Kubewarden&#x27;s Custom Resources.
This controller creates parts of the Kubewarden stack.
It also translates Kubewarden configuration into Kubernetes directives.</p>
<p>The <code>kubewarden-controller</code> registers the needed
<code>MutatingWebhookConfiguration</code> or
<code>ValidatingWebhookConfiguration</code>
objects with the Kubernetes API server.</p>
</li>
<li>
<p><a href="/next/tutorials/writing-policies">Kubewarden policies</a>
are WebAssembly modules holding the validation or mutation logic.
WebAssembly modules have detailed documentation in the
<a href="/next/tutorials/writing-policies">writing policies</a> sections.</p>
</li>
<li>
<p>The <a href="https://github.com/kubewarden/policy-server" target="_blank" rel="noopener noreferrer">PolicyServer</a>
receives requests for validation.
It validates the requests by executing Kubewarden policies.</p>
</li>
<li>
<p>The <a href="https://github.com/kubewarden/audit-scanner" target="_blank" rel="noopener noreferrer">audit scanner</a>
inspects the resources already in the cluster.
It identifies those violating Kubewarden policies.</p>
<p><a href="/next/explanations/audit-scanner">Audit scanner</a>
constantly checks the resources declared in the cluster,
flagging the ones that no longer adhere with the deployed Kubewarden policies.</p>
<!-- -->
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-journey-of-a-kubewarden-policy">The journey of a Kubewarden policy<a href="#the-journey-of-a-kubewarden-policy" class="hash-link" aria-label="Direct link to The journey of a Kubewarden policy" title="Direct link to The journey of a Kubewarden policy">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="default-policyserver">Default PolicyServer<a href="#default-policyserver" class="hash-link" aria-label="Direct link to Default PolicyServer" title="Direct link to Default PolicyServer">â€‹</a></h3>
<p>On a new cluster, the Kubewarden components defined are:</p>
<ul>
<li>Custom Resource Definitions (CRD)</li>
<li>The <code>kubewarden-controller</code> Deployment</li>
<li>A PolicyServer Custom Resource named <code>default</code>.</li>
</ul>
<p>When the <code>kubewarden-controller</code> notices the default PolicyServer resource,
it creates a <code>policy-server</code> deployment of the PolicyServer component.</p>
<p>Kubewarden works as a Kubernetes Admission Webhook.
Kubernetes specifies using
<a href="https://en.wikipedia.org/wiki/Transport_Layer_Security" target="_blank" rel="noopener noreferrer">Transport Layer Security</a>
(TLS) to secure all Webhook endpoints.
The <code>kubewarden-controller</code> sets up this secure communication
by:</p>
<ol>
<li>Generating a self-signed Certificate Authority</li>
<li>Use this CA to generate a TLS certificate key for the <code>policy-server</code> Service.</li>
</ol>
<p>These objects are all stored as <code>Secret</code> resources in Kubernetes.</p>
<p>Finally, <code>kubewarden-controller</code> creates the <code>policy-server</code> Deployment
and a Kubernetes ClusterIP Service
to expose it inside the cluster network.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="defining-the-first-policy">Defining the first policy<a href="#defining-the-first-policy" class="hash-link" aria-label="Direct link to Defining the first policy" title="Direct link to Defining the first policy">â€‹</a></h3>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>A policy must define which <code>policy-server</code> it must run on.
It <strong>binds</strong> to a <code>policy-server</code> instance.
You can have different policies with the same Wasm module and settings
running in many PolicyServers.
However, you can&#x27;t have a single policy definition that runs in many PolicyServers.</p></div></div>
<p>The <code>kubewarden-controller</code> notices the new <code>ClusterAdmissionPolicy</code> resource and
so finds the bound <code>policy-server</code> and reconciles it.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reconciliation-of-a-policy-server">Reconciliation of a <code>policy-server</code><a href="#reconciliation-of-a-policy-server" class="hash-link" aria-label="Direct link to reconciliation-of-a-policy-server" title="Direct link to reconciliation-of-a-policy-server">â€‹</a></h3>
<p>When creating, modifying or deleting a <code>ClusterAdmissionPolicy</code> or <code>AdmissionPolicy</code>,
a reconciliation loop activates in <code>kubewarden-controller</code>,
for the <code>policy-server</code> owning the policy.
This reconciliation loop creates a <code>ConfigMap</code> with all the policies bound to the <code>policy-server</code>.
Then the Deployment rollout of the <code>policy-server</code> starts.
It results in starting the new <code>policy-server</code> instance with the updated configuration.</p>
<p>At start time, the <code>policy-server</code> reads its configuration from the ConfigMap
and downloads all the Kubewarden policies specified.
You can download Kubewarden policies from remote HTTP servers and container registries.</p>
<p>You use policy settings parameters to tune a policies&#x27; behavior.
After startup and policy download the <code>policy-server</code>
checks the policy settings provided by the user are valid.</p>
<p>The <code>policy-server</code> validates policy settings by invoking
the <code>validate_setting</code> function exposed by each policy.
There is further documentation in the
<a href="/next/reference/spec/intro-spec">specification reference</a>
section of the documentation.</p>
<p>If one or more policies received wrong configuration parameters,
from the policy specification provided by the user,
then any admission requests evaluated by that policy return an error.</p>
<p>When Kubewarden has configured all policies,
the <code>policy-server</code>
spawns a pool of worker threads to evaluate incoming requests
using the Kubewarden policies specified by the user.</p>
<p>Finally, the <code>policy-server</code> starts a HTTPS server,
listening to incoming validation requests.
Kubewarden uses the TLS key and certificate
created by the Kubewarden controller
to secure the web server.</p>
<p>The web server exposes each policy by a dedicated path
following the naming convention: <code>/validate/&lt;policy ID&gt;</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="making-kubernetes-aware-of-the-policy">Making Kubernetes aware of the policy<a href="#making-kubernetes-aware-of-the-policy" class="hash-link" aria-label="Direct link to Making Kubernetes aware of the policy" title="Direct link to Making Kubernetes aware of the policy">â€‹</a></h3>
<p>All <code>policy-server</code> instances have a
<a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/" target="_blank" rel="noopener noreferrer"><code>Readiness Probe</code></a>,
that <code>kubewarden-controller</code> uses to check when
the <code>policy-server</code> Deployment is ready to evaluate an
<a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response" target="_blank" rel="noopener noreferrer"><code>AdmissionReview</code></a>.</p>
<p>Once Kubewarden marks the <code>policy-server</code> deployment as &#x27;uniquely reachable&#x27; or <code>Ready</code>,
the <code>kubewarden-controller</code> makes the Kubernetes API server aware of the new policy.
This is by creating either a <code>MutatingWebhookConfiguration</code> or a <code>ValidatingWebhookConfiguration</code> object.
In this context, &#x27;uniquely reachable&#x27;,
means that all the PolicyServer instances in the cluster have the latest policy configuration installed.
The distinction, is a fine point, but is necessary,
due to how roll-out of PolicyServers works.
It&#x27;s possible to have the same policy,
on different PolicyServers with different configurations.</p>
<p>Each policy has a dedicated
<code>MutatingWebhookConfiguration</code> or <code>ValidatingWebhookConfiguration</code>
pointing to the Webhook endpoint served by <code>policy-server</code>.
The endpoint is reachable at the <code>/validate/&lt;policy ID&gt;</code> URL.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="policy-in-action">Policy in action<a href="#policy-in-action" class="hash-link" aria-label="Direct link to Policy in action" title="Direct link to Policy in action">â€‹</a></h3>
<p>Now that all the necessary plumbing is complete,
Kubernetes starts sending Admission Review requests to the right <code>policy-server</code> endpoints.</p>
<p>A <code>policy-server</code> receives the Admission Request object and,
based on the endpoint that received the request,
uses the correct policy to evaluate it.</p>
<p>Kubewarden evaluates each policy inside its own dedicated WebAssembly sand-box.
The communication between a <code>policy-server</code> instance (the &quot;host&quot;)
and the WebAssembly policy (the &quot;guest&quot;)
uses the waPC communication protocol.
The protocol description is part of the
<a href="/next/tutorials/writing-policies">writing policies</a> documentation.
Policies can also use the interfaces provided by the
<a href="/next/tutorials/writing-policies/wasi/intro-wasi">Web Assembly System Interface</a>
(WASI).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-kubewarden-handles-many-policyserver-and-policies">How Kubewarden handles many PolicyServer and policies<a href="#how-kubewarden-handles-many-policyserver-and-policies" class="hash-link" aria-label="Direct link to How Kubewarden handles many PolicyServer and policies" title="Direct link to How Kubewarden handles many PolicyServer and policies">â€‹</a></h2>
<p>A cluster can have many PolicyServers and Kubewarden policies defined.
There are benefits of having many PolicyServers:</p>
<ul>
<li>
<p>You can isolate noisy namespaces or tenants,
those generating many policy evaluations,
from the rest of the cluster so as not to adversely affect other cluster operations.</p>
</li>
<li>
<p>You can run mission-critical policies in a dedicated PolicyServer pool,
making your infrastructure more resilient.</p>
</li>
</ul>
<p>A PolicyServer resource defines each <code>policy-server</code>
and a <code>ClusterAdmissionPolicy</code> or <code>AdmissionPolicy</code> resource defines each policy.</p>
<p>A <code>ClusterAdmissionPolicy</code> and an <code>AdmissionPolicy</code> bind to a <code>policy-server</code>.
Any <code>ClusterAdmissionPolicy</code> not specifying a <code>policy-server</code>
binds to the default PolicyServer.
If a <code>ClusterAdmissionPolicy</code> references a <code>policy-server</code>
that doesn&#x27;t exist, its state is <code>unschedulable</code>.</p>
<p>Each <code>policy-server</code> defines many validation endpoints,
one for each policy defined in its configuration file.
You can load the same policy many times,
with different configuration parameters.</p>
<p>The <code>ValidatingWebhookConfiguration</code> and <code>MutatingWebhookConfiguration</code> resources
make the Kubernetes API server aware of these policies.
Then <code>kubewarden-controller</code> keeps the API server
and configuration resources in synchronization.</p>
<p>The Kubernetes API server dispatches incoming admission requests
to the correct validation endpoint exposed by <code>policy-server</code>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kubewarden/docs/edit/main/docs/explanations/architecture.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-01-30T16:59:28.000Z" itemprop="dateModified">Jan 30, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/next/explanations/audit-scanner/policy-reports"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Policy Reports</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/next/howtos/tasks"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Common tasks</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-a-policy" class="table-of-contents__link toc-highlight">What <em>is</em> a policy?</a></li><li><a href="#design-principles" class="table-of-contents__link toc-highlight">Design principles</a><ul><li><a href="#making-use-of-core-kubernetes-features" class="table-of-contents__link toc-highlight">Making use of core Kubernetes features</a></li><li><a href="#effectively-uses-kubernetes-architecture" class="table-of-contents__link toc-highlight">Effectively uses Kubernetes architecture</a></li><li><a href="#extensible-policy-definition" class="table-of-contents__link toc-highlight">Extensible policy definition</a></li><li><a href="#direct-admission-control" class="table-of-contents__link toc-highlight">Direct admission control</a></li><li><a href="#oci-based-policy-artifacts" class="table-of-contents__link toc-highlight">OCI based policy artifacts</a></li><li><a href="#fine-grained-policy-application" class="table-of-contents__link toc-highlight">Fine-grained policy application</a></li></ul></li><li><a href="#the-kubewarden-stack" class="table-of-contents__link toc-highlight">The Kubewarden stack</a></li><li><a href="#the-journey-of-a-kubewarden-policy" class="table-of-contents__link toc-highlight">The journey of a Kubewarden policy</a><ul><li><a href="#default-policyserver" class="table-of-contents__link toc-highlight">Default PolicyServer</a></li><li><a href="#defining-the-first-policy" class="table-of-contents__link toc-highlight">Defining the first policy</a></li><li><a href="#reconciliation-of-a-policy-server" class="table-of-contents__link toc-highlight">Reconciliation of a <code>policy-server</code></a></li><li><a href="#making-kubernetes-aware-of-the-policy" class="table-of-contents__link toc-highlight">Making Kubernetes aware of the policy</a></li><li><a href="#policy-in-action" class="table-of-contents__link toc-highlight">Policy in action</a></li></ul></li><li><a href="#how-kubewarden-handles-many-policyserver-and-policies" class="table-of-contents__link toc-highlight">How Kubewarden handles many PolicyServer and policies</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Kubewarden is a <a target="_blank" href="https://cncf.io">CNCF</a> project,
      originally created by <a target="_blank" href="https://rancher.com">SUSE Rancher</a>.<br>Copyright Â© 2025 Kubewarden project authors. All rights reserved.</div></div></div></footer></div>
</body>
</html>